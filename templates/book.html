{% extends "base.html" %} {% block title %}Seat Selection{% endblock %} {% block
content %}
<h2>Select Seat — {{ flight.flight_number }}</h2>

<p><strong>Route:</strong> {{ flight.source }} → {{ flight.destination }}</p>
<p><strong>Departure:</strong> {{ flight.departure_time }}</p>
<!--<p class="price-tag">₹{{ flight.get_dynamic_price }}</p>-->

<form method="POST" class="booking-form">
  <input type="text" name="name" placeholder="Passenger Name" required />

  <h3>Select Seat</h3>

  <div class="seat-map">
    {% for row in range(1, 11) %}
    <div class="seat-row">
      {% for col in ["A","B","C","D","E","F"] %} {% set seat = row|string + col
      %}
      <div
        class="seat {% if seat in booked_seats %}booked{% endif %}"
        data-seat="{{ seat }}"
      >
        {{ seat }}
      </div>
      {% endfor %}
    </div>
    {% endfor %}
  </div>

  <div class="seat-legend">
    <span><span class="legend available"></span> Available</span>
    <span><span class="legend selected"></span> Selected</span>
    <span><span class="legend booked"></span> Booked</span>
  </div>

  <input type="hidden" name="seat" id="seatInput" required />

  <button type="submit">Confirm Booking</button>
</form>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const seats = document.querySelectorAll(".seat");
    const seatInput = document.getElementById("seatInput");

    seats.forEach((seat) => {
      if (!seat.classList.contains("booked")) {
        seat.addEventListener("click", function () {
          // remove previous selection
          seats.forEach((s) => s.classList.remove("selected"));

          // select current seat
          seat.classList.add("selected");

          // store value for backend
          seatInput.value = seat.dataset.seat;
        });
      }
    });
  });
</script>
{% endblock %}
